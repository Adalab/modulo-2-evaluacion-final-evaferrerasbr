"use strict";const button=document.querySelector(".js-btn"),results=document.querySelector(".js-list--results"),favoriteList=document.querySelector(".js-list--favorites");let search="",shows=[],favoriteShows=[],favoriteId=[],savedFavorites=[];function handlerEvent(){shows=[],search=document.querySelector(".js-input").value,searchShows()}function searchShows(){fetch("//api.tvmaze.com/search/shows?q="+search).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++)shows.push(e[t].show);paintShows(),listenSearch()})}function paintShows(){results.innerHTML="";for(let e=0;e<shows.length;e++){const t=document.createElement("li"),s=shows[e].id;t.setAttribute("id",s),t.classList.add("list--item","js-list--item");for(const e of favoriteShows)parseInt(e.id)===s&&t.classList.add("favorite");const o=document.createElement("img");shows[e].image?o.setAttribute("src",shows[e].image.medium):o.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),o.classList.add("img"),t.appendChild(o);const a=document.createElement("h3"),i=document.createTextNode(""+shows[e].name);a.appendChild(i),t.appendChild(a),results.appendChild(t)}}function paintFavorite(){favoriteList.innerHTML="";for(let e=0;e<favoriteShows.length;e++){const t=document.createElement("li"),s=document.createElement("img");s.src=favoriteShows[e].image,s.classList.add("img"),t.appendChild(s);const o=document.createElement("h3"),a=document.createTextNode(""+favoriteShows[e].name);o.appendChild(a),t.appendChild(o),favoriteList.appendChild(t)}}function getFavorites(e){const t=e.currentTarget,s=t.querySelector(".img"),o={name:t.querySelector("h3").innerHTML,image:s.src,id:e.currentTarget.id},a=parseInt(t.id);favoriteId=favoriteShows.map((function(e){return parseInt(e.id)}));const i=favoriteId.indexOf(a);-1===i?favoriteShows.push(o):favoriteShows.splice(i,1),paintFavorite(),paintShows(),listenSearch(),setLocalStorage()}function listenSearch(){const e=document.querySelectorAll(".js-list--item");for(const t of e)t.addEventListener("click",getFavorites)}function setLocalStorage(){const e=JSON.stringify(favoriteShows);localStorage.setItem("favorites",e)}function getLocalStorage(){const e=localStorage.getItem("favorites");savedFavorites=JSON.parse(e),null!==savedFavorites?(favoriteShows=savedFavorites,paintFavorite(),listenSearch()):handlerEvent()}getLocalStorage(),button.addEventListener("click",handlerEvent);